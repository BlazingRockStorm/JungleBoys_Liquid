<% if comment.parent_id == nil %>
<div id="comment_<%= comment.id %>">
    <div class="row">
        <div class="col-md-1">
            <% if comment.user.user_pic.present? %>
                <%= image_tag(comment.user.user_pic, :height=>'50px', :width=>'50px', :style => 'border-radius: 50%') %>
            <% else %>
                <%= image_tag("/user.png", :height=>'50px', :width=>'50px',:style => 'border-radius: 50%') %>
            <% end %>
        </div>
        <div class="col-md-9">
            <a href="#" style="font-weight:bold"><%= comment.user.username %></a>
            <p><%= comment.created_at %>
             <% for i in 1..5 %>
                <% if i > comment.rating.stars %>
                    <i class="fas fa-star"></i>
                    <% next %>                        
                <% end %>
                <i class="fas fa-star rated"></i>
            <% end %>

            </p>
        </div>
        <div class="col-md-2">
            <% if user_signed_in? && current_user.id == comment.user_id %>
            <%= link_to 'Delete', room_comment_path(comment.room_id, comment), method: :delete, remote: true, data: { confirm: 'Are you sure?' } %>
            <button id="edit_button">Edit</button>
           <% end %>
        </div>
    </div>
    
    <p class="offset-md-1"><%= comment.text_content %></p>
    <div style="display:none" id="edit_form">
    <%= form_for [comment.room, comment], method: :patch, html: {class: "form-inline"}, remote:true do |f| %>
                
            <div class="form-group" style="width:100%">
                <%= f.hidden_field :id, value: comment.id %>
                <%= f.hidden_field :room_id, value: comment.room.id %>
                <%= f.text_field :text_content, :class => "comment-box form-control", :style=>"width:50%",
                    :required => true, :autocomplete => 'off', placeholder: "Edit comment" %>
                <%= f.fields_for :rating, update_ratings_path do |rating_form| %>
                    <p>
                        <%= rating_form.hidden_field :id, value: comment.rating.id %>
                        <%= rating_form.hidden_field :comment_id, value: comment.id %>
                        <%= rating_form.hidden_field :room_id, value: comment.room.id %>    
                        <%= rating_form.hidden_field :stars %>                    
                    </p>
                    <% end %>
                <h2 id="your_rating">
                    <i id="1" class="fas fa-star"></i>
                    <i id="2" class="fas fa-star"></i>
                    <i id="3" class="fas fa-star"></i>
                    <i id="4" class="fas fa-star"></i>
                    <i id="5" class="fas fa-star"></i>
                </h2>
            
                <p id="value"></p>    

                <button id="edit_cancel_button" type="button" class="btn btn-danger">Cancel</button>    
                <%= f.submit "Edit", id: "submit", class: "btn btn-primary" %>
            </div>
        <% end %>
        </div>
        
        
    <% if user_signed_in? %>    
    <div class="offset-md-1" id="reply_form">
    <%= form_for [comment.room, Comment.new], html: {class: "form-inline"}, remote:true do |f| %>
                
            <div class="form-group" style="width:100%">
                <%= f.hidden_field :user_id, value: current_user.id %>
                <%= f.hidden_field :parent_id, value: comment.id %>
                <%= f.hidden_field :room_id, value: comment.room.id %>
                <%= f.text_field :text_content, :class => "comment-box form-control", :style=>"width:50%",
                    :required => true, :autocomplete => 'off', placeholder: "Reply" %>
                    
                <%= f.submit "Reply", id: "reply_submit", class: "btn btn-primary" %>
            </div>
    <% end %>
    </div>    
    <% end %>
</div>    
<% end %>